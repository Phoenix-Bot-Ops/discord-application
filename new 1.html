<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Discord Staff Application</title>
    <!-- Load Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Use Inter Font -->
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap');
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f7f9fb;
        }
        /* Custom scrollbar for textareas */
        textarea::-webkit-scrollbar {
            width: 8px;
        }
        textarea::-webkit-scrollbar-thumb {
            background-color: #6366f1;
            border-radius: 4px;
        }
        textarea::-webkit-scrollbar-track {
            background-color: #e5e7eb;
        }
    </style>
</head>
<body>

    <div id="app" class="min-h-screen flex flex-col items-center p-4 sm:p-8">
        <!-- Header -->
        <div class="w-full max-w-2xl mb-6 text-center">
            <h1 class="text-4xl font-extrabold text-indigo-700 mb-2">Staff Application</h1>
            <p class="text-lg text-gray-600">Join our editing server team!</p>
        </div>

        <!-- Application Form Card -->
        <div class="w-full max-w-2xl bg-white shadow-xl rounded-xl p-6 sm:p-10 border border-gray-200">
            <form id="application-form" onsubmit="handleFormSubmission(event)">

                <!-- Discord Handle -->
                <div class="mb-6">
                    <label for="discordHandle" class="block text-sm font-medium text-gray-700 mb-2">
                        Discord Username/Handle <span class="text-red-500">*</span>
                    </label>
                    <input type="text" id="discordHandle" required
                           placeholder="@username#1234 or @newusername"
                           class="w-full p-3 border border-gray-300 rounded-lg focus:ring-indigo-500 focus:border-indigo-500 transition duration-150 ease-in-out">
                </div>

                <!-- Age -->
                <div class="mb-6">
                    <label for="age" class="block text-sm font-medium text-gray-700 mb-2">
                        Age <span class="text-red-500">*</span>
                    </label>
                    <input type="number" id="age" required min="13" max="100"
                           placeholder="Must be 13 or older"
                           class="w-full p-3 border border-gray-300 rounded-lg focus:ring-indigo-500 focus:border-indigo-500 transition duration-150 ease-in-out">
                </div>

                <!-- Time Zone -->
                <div class="mb-6">
                    <label for="timeZone" class="block text-sm font-medium text-gray-700 mb-2">
                        Time Zone (e.g., EST, UTC+1, PST) <span class="text-red-500">*</span>
                    </label>
                    <input type="text" id="timeZone" required
                           placeholder="Specify your time zone to help with scheduling"
                           class="w-full p-3 border border-gray-300 rounded-lg focus:ring-indigo-500 focus:border-indigo-500 transition duration-150 ease-in-out">
                </div>

                <!-- Editing Experience -->
                <div class="mb-6">
                    <label for="experience" class="block text-sm font-medium text-gray-700 mb-2">
                        Describe your editing experience and skills <span class="text-red-500">*</span>
                    </label>
                    <textarea id="experience" rows="4" required maxlength="1000"
                              placeholder="Mention software, key projects, and relevant skills."
                              class="w-full p-3 border border-gray-300 rounded-lg focus:ring-indigo-500 focus:border-indigo-500 resize-y transition duration-150 ease-in-out"></textarea>
                </div>

                <!-- Availability -->
                <div class="mb-6">
                    <label for="availability" class="block text-sm font-medium text-gray-700 mb-2">
                        What is your weekly availability? (Hours per week and best days) <span class="text-red-500">*</span>
                    </label>
                    <textarea id="availability" rows="3" required maxlength="500"
                              placeholder="e.g., 10-15 hours/week, primarily evenings and weekends."
                              class="w-full p-3 border border-gray-300 rounded-lg focus:ring-indigo-500 focus:border-indigo-500 resize-y transition duration-150 ease-in-out"></textarea>
                </div>

                <!-- Reason for Applying -->
                <div class="mb-6">
                    <label for="reason" class="block text-sm font-medium text-gray-700 mb-2">
                        Why do you want to be a staff member? <span class="text-red-500">*</span>
                    </label>
                    <textarea id="reason" rows="4" required maxlength="1000"
                              placeholder="Explain your motivation and what you hope to contribute to the community."
                              class="w-full p-3 border border-gray-300 rounded-lg focus:ring-indigo-500 focus:border-indigo-500 resize-y transition duration-150 ease-in-out"></textarea>
                </div>

                <!-- Portfolio Link (Optional but highly recommended) -->
                <div class="mb-8">
                    <label for="portfolioLink" class="block text-sm font-medium text-gray-700 mb-2">
                        Portfolio Link (Optional, but highly recommended)
                    </label>
                    <input type="url" id="portfolioLink"
                           placeholder="Link to your portfolio, Google Drive, or YouTube showcase."
                           class="w-full p-3 border border-gray-300 rounded-lg focus:ring-indigo-500 focus:border-indigo-500 transition duration-150 ease-in-out">
                </div>

                <!-- Submission Button and Status -->
                <div id="status-message" class="mb-4 hidden p-3 rounded-lg text-sm font-medium text-center"></div>

                <button type="submit" id="submit-button"
                        class="w-full bg-indigo-600 text-white font-bold py-3 px-4 rounded-lg hover:bg-indigo-700 focus:outline-none focus:ring-4 focus:ring-indigo-500 focus:ring-opacity-50 transition duration-150 ease-in-out disabled:opacity-50 flex items-center justify-center">
                    Submit Application
                </button>
            </form>
        </div>
    </div>

    <!-- Webhook Submission Script -->
    <script type="text/javascript">
        // The Discord Webhook URL provided by the user.
        const WEBHOOK_URL = 'https://discordapp.com/api/webhooks/1444170032539107508/EQeY951cQ1kxLJkVtVXKYtz9w06Xaq57ce16HowUbQ3WfpJrkW5J_n0sNz5liaoC_dGQ';

        function displayStatus(message, classes) {
            const statusMessage = document.getElementById('status-message');
            statusMessage.textContent = message;
            statusMessage.className = `mb-4 p-3 rounded-lg text-sm font-medium text-center ${classes}`;
            statusMessage.classList.remove('hidden');
        }

        // Global function to handle form submission
        window.handleFormSubmission = async function(event) {
            event.preventDefault();

            const submitButton = document.getElementById('submit-button');
            const statusMessage = document.getElementById('status-message');

            // Disable button and show loading
            submitButton.disabled = true;
            submitButton.textContent = 'Sending to Discord...';
            statusMessage.classList.add('hidden');

            try {
                // 1. Gather form data
                const discordHandle = document.getElementById('discordHandle').value.trim();
                const age = document.getElementById('age').value.trim();
                const timeZone = document.getElementById('timeZone').value.trim();
                const experience = document.getElementById('experience').value.trim();
                const availability = document.getElementById('availability').value.trim();
                const reason = document.getElementById('reason').value.trim();
                const portfolioLink = document.getElementById('portfolioLink').value.trim();
                const submittedAt = new Date().toLocaleString();

                // 2. Format data for a Discord Embed
                const embed = {
                    title: `New Staff Application from ${discordHandle}`,
                    description: `A new candidate has submitted an application for the editing server staff team.`,
                    color: 3447003, // A nice blue/indigo color for Discord embeds
                    timestamp: new Date().toISOString(),
                    fields: [
                        { name: "Discord Handle", value: discordHandle, inline: true },
                        { name: "Age", value: age, inline: true },
                        { name: "Time Zone", value: timeZone, inline: true },
                        { name: "Availability (Weekly)", value: availability, inline: false },
                        { name: "Editing Experience/Skills", value: experience.substring(0, 1024), inline: false },
                        { name: "Reason for Applying", value: reason.substring(0, 1024), inline: false },
                    ],
                    footer: { text: `Submitted on ${submittedAt}` }
                };

                // Add portfolio link if provided
                if (portfolioLink) {
                    embed.fields.push({ name: "Portfolio Link", value: portfolioLink, inline: false });
                }

                const payload = {
                    username: "Server Application Bot",
                    avatar_url: "https://placehold.co/100x100/6366f1/ffffff?text=APP",
                    embeds: [embed]
                };

                // 3. Send the POST request to the Discord Webhook
                const response = await fetch(WEBHOOK_URL, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(payload)
                });

                // 4. Handle response
                if (response.ok) {
                    displayStatus('Application successfully sent to Discord!', 'bg-green-100 text-green-700');
                    document.getElementById('application-form').reset();
                } else if (response.status === 429) {
                    // Discord rate limit handler
                    displayStatus('Error: Submission rate limited. Please try again in a moment.', 'bg-yellow-100 text-yellow-800');
                } else {
                    // General webhook error (e.g., invalid token, invalid payload structure)
                    const errorText = await response.text();
                    console.error("Discord Webhook Error:", response.status, errorText);
                    displayStatus(`Error: Failed to send application (${response.status}). Check console for details.`, 'bg-red-100 text-red-700');
                }

            } catch (e) {
                console.error("Network or Fetch Error:", e);
                displayStatus('Error: Failed to connect to the webhook URL. Check your internet or webhook link.', 'bg-red-100 text-red-700');
            } finally {
                // Re-enable button
                submitButton.disabled = false;
                submitButton.textContent = 'Submit Application';
            }
        }
        
        // Ensure the button is enabled immediately since there's no auth wait
        document.getElementById('submit-button').disabled = false;
    </script>
</body>
</html>